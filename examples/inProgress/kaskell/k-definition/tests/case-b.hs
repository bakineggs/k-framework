module CaseB where
  -- test1lhs = case v of { P1 -> match1 ; Pn -> matchn }
  -- test1rhs = case v of { P1 -> match1 ; _ -> case v of { Pn -> matchn
  --                                                      ; _  -> error "No match" }}

  test2lhs = case v of { P1 | g1 -> match1 ; P2 | g2 -> match2 ; P3 -> match3 ; Pn | gn -> matchn }
  test2rhs = case v of { P1 | g1 -> match1
                       ; _ -> case v of { P2 | g2 -> match2
                                        ; _ -> case v of { P3 -> match3
                                                         ; _ -> case v of { Pn | gn -> matchn
                                                                          ; _ -> error "No match" }}}}



{-
 Parses as:

  test1:
 (Module (SrcLoc "tests/case-b.hs" 1 1) (ModuleName "CaseB") ([]) Nothing Nothing ([]) ((:)(PatBind (SrcLoc "tests/case-b.hs" 2 3) (PVar (Ident "test1lhs")) Nothing (UnGuardedRhs (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 2 26) (PApp (UnQual (Ident "P1")) ([])) (UnGuardedAlt (Var (UnQual (Ident "match1")))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 2 41) (PApp (UnQual (Ident "Pn")) ([])) (UnGuardedAlt (Var (UnQual (Ident "matchn")))) (BDecls ([]))) ([]))))) (BDecls ([]))) ((:)(PatBind (SrcLoc "tests/case-b.hs" 3 3) (PVar (Ident "test1rhs")) Nothing (UnGuardedRhs (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 3 26) (PApp (UnQual (Ident "P1")) ([])) (UnGuardedAlt (Var (UnQual (Ident "match1")))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 3 41) PWildCard (UnGuardedAlt (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 3 58) (PApp (UnQual (Ident "Pn")) ([])) (UnGuardedAlt (Var (UnQual (Ident "matchn")))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 4 58) PWildCard (UnGuardedAlt (App (Var (UnQual (Ident "error"))) (Lit (String "No match")))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))

 test2:
 (Module (SrcLoc "tests/case-b.hs" 1 1) (ModuleName "CaseB") ([]) Nothing Nothing ([]) ((:)(PatBind (SrcLoc "tests/case-b.hs" 6 3) (PVar (Ident "test2lhs")) Nothing (UnGuardedRhs (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 6 26) (PApp (UnQual (Ident "P1")) ([])) (GuardedAlts ((:)(GuardedAlt (SrcLoc "tests/case-b.hs" 6 29) ((:)(Qualifier (Var (UnQual (Ident "g1")))) ([])) (Var (UnQual (Ident "match1")))) ([]))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 6 46) (PApp (UnQual (Ident "P2")) ([])) (GuardedAlts ((:)(GuardedAlt (SrcLoc "tests/case-b.hs" 6 49) ((:)(Qualifier (Var (UnQual (Ident "g2")))) ([])) (Var (UnQual (Ident "match2")))) ([]))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 6 66) (PApp (UnQual (Ident "P3")) ([])) (UnGuardedAlt (Var (UnQual (Ident "match3")))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 6 81) (PApp (UnQual (Ident "Pn")) ([])) (GuardedAlts ((:)(GuardedAlt (SrcLoc "tests/case-b.hs" 6 84) ((:)(Qualifier (Var (UnQual (Ident "gn")))) ([])) (Var (UnQual (Ident "matchn")))) ([]))) (BDecls ([]))) ([]))))))) (BDecls ([]))) ((:)(PatBind (SrcLoc "tests/case-b.hs" 7 3) (PVar (Ident "test2rhs")) Nothing (UnGuardedRhs (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 7 26) (PApp (UnQual (Ident "P1")) ([])) (GuardedAlts ((:)(GuardedAlt (SrcLoc "tests/case-b.hs" 7 29) ((:)(Qualifier (Var (UnQual (Ident "g1")))) ([])) (Var (UnQual (Ident "match1")))) ([]))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 8 26) PWildCard (UnGuardedAlt (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 8 43) (PApp (UnQual (Ident "P2")) ([])) (GuardedAlts ((:)(GuardedAlt (SrcLoc "tests/case-b.hs" 8 46) ((:)(Qualifier (Var (UnQual (Ident "g2")))) ([])) (Var (UnQual (Ident "match2")))) ([]))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 9 43) PWildCard (UnGuardedAlt (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 9 60) (PApp (UnQual (Ident "P3")) ([])) (UnGuardedAlt (Var (UnQual (Ident "match3")))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 10 60) PWildCard (UnGuardedAlt (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 10 77) (PApp (UnQual (Ident "Pn")) ([])) (GuardedAlts ((:)(GuardedAlt (SrcLoc "tests/case-b.hs" 10 80) ((:)(Qualifier (Var (UnQual (Ident "gn")))) ([])) (Var (UnQual (Ident "matchn")))) ([]))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 11 77) PWildCard (UnGuardedAlt (App (Var (UnQual (Ident "error"))) (Lit (String "No match")))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))

 After:

 test1:
  (Module (SrcLoc "tests/case-b.hs" 1 1) (ModuleName "CaseB") ([]) Nothing Nothing ([]) ((:)(PatBind (SrcLoc "tests/case-b.hs" 2 3) (PVar (Ident "test1lhs")) Nothing (UnGuardedRhs (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 2 26) (PApp (UnQual (Ident "P1")) ([])) (UnGuardedAlt (Var (UnQual (Ident "match1")))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 2 26) PWildCard (UnGuardedAlt (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 2 41) (PApp (UnQual (Ident "Pn")) ([])) (UnGuardedAlt (Var (UnQual (Ident "matchn")))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 2 41) PWildCard (UnGuardedAlt (App (Var (UnQual (Ident "error"))) (Lit (String "No match")))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))) (BDecls ([]))) ((:)(PatBind (SrcLoc "tests/case-b.hs" 3 3) (PVar (Ident "test1rhs")) Nothing (UnGuardedRhs (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 3 26) (PApp (UnQual (Ident "P1")) ([])) (UnGuardedAlt (Var (UnQual (Ident "match1")))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 3 41) PWildCard (UnGuardedAlt (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 3 58) (PApp (UnQual (Ident "Pn")) ([])) (UnGuardedAlt (Var (UnQual (Ident "matchn")))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 4 58) PWildCard (UnGuardedAlt (App (Var (UnQual (Ident "error"))) (Lit (String "No match")))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))

 test2:
  (Module (SrcLoc "tests/case-b.hs" 1 1) (ModuleName "CaseB") ([]) Nothing Nothing ([]) ((:)(PatBind (SrcLoc "tests/case-b.hs" 6 3) (PVar (Ident "test2lhs")) Nothing (UnGuardedRhs (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 6 26) (PApp (UnQual (Ident "P1")) ([])) (GuardedAlts ((:)(GuardedAlt (SrcLoc "tests/case-b.hs" 6 29) ((:)(Qualifier (Var (UnQual (Ident "g1")))) ([])) (Var (UnQual (Ident "match1")))) ([]))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 6 26) PWildCard (UnGuardedAlt (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 6 46) (PApp (UnQual (Ident "P2")) ([])) (GuardedAlts ((:)(GuardedAlt (SrcLoc "tests/case-b.hs" 6 49) ((:)(Qualifier (Var (UnQual (Ident "g2")))) ([])) (Var (UnQual (Ident "match2")))) ([]))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 6 46) PWildCard (UnGuardedAlt (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 6 66) (PApp (UnQual (Ident "P3")) ([])) (UnGuardedAlt (Var (UnQual (Ident "match3")))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 6 66) PWildCard (UnGuardedAlt (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 6 81) (PApp (UnQual (Ident "Pn")) ([])) (GuardedAlts ((:)(GuardedAlt (SrcLoc "tests/case-b.hs" 6 84) ((:)(Qualifier (Var (UnQual (Ident "gn")))) ([])) (Var (UnQual (Ident "matchn")))) ([]))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 6 81) PWildCard (UnGuardedAlt (App (Var (UnQual (Ident "error"))) (Lit (String "No match")))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))) (BDecls ([]))) ((:)(PatBind (SrcLoc "tests/case-b.hs" 7 3) (PVar (Ident "test2rhs")) Nothing (UnGuardedRhs (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 7 26) (PApp (UnQual (Ident "P1")) ([])) (GuardedAlts ((:)(GuardedAlt (SrcLoc "tests/case-b.hs" 7 29) ((:)(Qualifier (Var (UnQual (Ident "g1")))) ([])) (Var (UnQual (Ident "match1")))) ([]))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 8 26) PWildCard (UnGuardedAlt (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 8 43) (PApp (UnQual (Ident "P2")) ([])) (GuardedAlts ((:)(GuardedAlt (SrcLoc "tests/case-b.hs" 8 46) ((:)(Qualifier (Var (UnQual (Ident "g2")))) ([])) (Var (UnQual (Ident "match2")))) ([]))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 9 43) PWildCard (UnGuardedAlt (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 9 60) (PApp (UnQual (Ident "P3")) ([])) (UnGuardedAlt (Var (UnQual (Ident "match3")))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 10 60) PWildCard (UnGuardedAlt (Case (Var (UnQual (Ident "v"))) ((:)(Alt (SrcLoc "tests/case-b.hs" 10 77) (PApp (UnQual (Ident "Pn")) ([])) (GuardedAlts ((:)(GuardedAlt (SrcLoc "tests/case-b.hs" 10 80) ((:)(Qualifier (Var (UnQual (Ident "gn")))) ([])) (Var (UnQual (Ident "matchn")))) ([]))) (BDecls ([]))) ((:)(Alt (SrcLoc "tests/case-b.hs" 11 77) PWildCard (UnGuardedAlt (App (Var (UnQual (Ident "error"))) (Lit (String "No match")))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))) (BDecls ([]))) ([]))))



-}